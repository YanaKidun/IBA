-- Создание новой базы данных с именем my_database
CREATE DATABASE my_database;
-- Использование новой базы данных
USE my_database;
-- Создание таблицы с секционированием по дате добавления
CREATE TABLE users (
    id INT NOT NULL,
    name VARCHAR(100) NOT NULL,
    phone VARCHAR(15) NOT NULL,
    birthday DATE NOT NULL,
    address_line VARCHAR(255),
    inn VARCHAR(12),
    snils VARCHAR(14),
    create_date DATE NOT NULL,  -- Дата добавления записи
    PRIMARY KEY (id, create_date)  -- Первичный ключ
)
PARTITION BY RANGE (YEAR(create_date)) (  -- Секционирование по годам
    PARTITION p_before_2022 VALUES LESS THAN (2022),  -- Записи до 2022 года
    PARTITION p_2022 VALUES LESS THAN (2023),         -- Записи за 2022 год
    PARTITION p_2023 VALUES LESS THAN (2024),         -- Записи за 2023 год
    PARTITION p_2024 VALUES LESS THAN (2025)          -- Записи за 2024 год
);

-- Вставка записей в разные секции

-- Записи до 2022 года (попадут в секцию p_before_2022)
INSERT INTO users (id, name, phone, birthday, address_line, inn, snils, create_date)
VALUES
(1, 'Иван Иванов', '+79001234567', '1990-05-15', 'ул. Ленина, д. 10', '123456789012', '123-456-789 01', '2021-12-15'),
(2, 'Мария Петрова', '+79007654321', '1985-03-10', 'ул. Пушкина, д. 15', '234567890123', '234-567-890 12', '2021-09-10'),
(3, 'Алексей Сидоров', '+79005551234', '1992-07-25', 'ул. Горького, д. 5', '345678901234', '345-678-901 23', '2021-08-05'),
(4, 'Ольга Смирнова', '+79004443322', '1991-12-01', 'ул. Гагарина, д. 7', '456789012345', '456-789-012 34', '2021-06-30'),
(5, 'Дмитрий Кузнецов', '+79003332211', '1989-09-17', 'ул. Чехова, д. 20', '567890123456', '567-890-123 45', '2021-04-18');

-- Записи за 2022 год (попадут в секцию p_2022)
INSERT INTO users (id, name, phone, birthday, address_line, inn, snils, create_date)
VALUES
(6, 'Наталья Ковалева', '+79002221100', '1995-11-30', 'ул. Тургенева, д. 3', '678901234567', '678-901-234 56', '2022-03-12'),
(7, 'Сергей Новиков', '+79001122334', '1987-04-22', 'ул. Лермонтова, д. 8', '789012345678', '789-012-345 67', '2022-05-25'),
(8, 'Екатерина Федорова', '+79000998877', '1993-06-14', 'ул. Толстого, д. 12', '890123456789', '890-123-456 78', '2022-07-04'),
(9, 'Анна Волкова', '+79008887766', '1986-08-19', 'ул. Достоевского, д. 2', '901234567890', '901-234-567 89', '2022-10-17'),
(10, 'Николай Васильев', '+79007776655', '1990-01-05', 'ул. Маяковского, д. 4', '012345678901', '012-345-678 90', '2022-12-01');

-- Записи за 2023 год (попадут в секцию p_2023)
INSERT INTO users (id, name, phone, birthday, address_line, inn, snils, create_date)
VALUES
(11, 'Игорь Павлов', '+79005552233', '1988-10-03', 'ул. Мира, д. 7', '111111111111', '111-111-111 11', '2023-01-10'),
(12, 'Лидия Гончарова', '+79007778899', '1994-02-23', 'ул. Лесная, д. 15', '222222222222', '222-222-222 22', '2023-03-18'),
(13, 'Светлана Воронцова', '+79006665544', '1989-11-11', 'ул. Советская, д. 8', '333333333333', '333-333-333 33', '2023-05-20'),
(14, 'Владимир Ефимов', '+79001111222', '1996-12-25', 'ул. Клубная, д. 9', '444444444444', '444-444-444 44', '2023-07-15'),
(15, 'Елена Тарасова', '+79004445566', '1991-09-09', 'ул. Дачная, д. 12', '555555555555', '555-555-555 55', '2023-09-29');

SELECT * FROM users;

